## 什么是一致性Hash
就是普通取模哈希算法的改良版，哈希函数计算方法不变，只不过是通过构建环状的 Hash 空间代替普通的线性 Hash 空间

## 一致性Hash解决的问题
分布式系统一个节点失效/或者新增节点后，如何继续能够对外提供良好的服务(常规的hash方案存在扩展能力差、容错能力不佳的问题)

首先，选择一个足够大的Hash空间（一般是 0 ~ 2^32）构成一个哈希环。

然后，对于缓存集群内的每个存储服务器节点计算 Hash 值，可以用服务器的 IP 或 主机名计算得到哈希值，计算得到的哈希值就是服务节点在 Hash 环上的位置。

最后，对每个需要存储的数据 key 同样也计算一次哈希值，计算之后的哈希也映射到环上，数据存储的位置是沿顺时针的方向找到的环上的第一个节点。

## 扩展能力提升
当缓存服务集群要新增/删除节点时，受影响的只有相邻节点的数据，其余节点存储的数据保持不动

## 容错能力提升
一致性哈希能把节点宕机造成的影响控制在顺时针相邻节点之间，避免对整个集群造成影响。

## 一致性哈希优化
### 数据倾斜问题
解决办法：建立虚拟节点

## 参考文章
https://mp.weixin.qq.com/s/GVLqUOg9Y2PGgi5rmFScpQ