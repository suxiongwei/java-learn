## 两阶段提交（2PC）
二阶段提交（2PC）是XA分布式事务协议的一种实现。

二阶段是事务管理器（TM）和资源管理器（RM）形成的**预提交和提交**两个阶段。<br/>
RM就是数据库（mysql/oracle），TM可以理解为JVM。

_多用于数据库层面_

**缺点**：阻塞线程的，没有超时机制

## TCC方案
TCC就是 try/confirm/cancel

try：是在业务逻辑阶段把数据操作更新到中间表并记录操作痕迹

confirm：是把所有中间步骤更新到原表操作

cancel：是回滚

因此，对于TM与RM的关系而言，TCC每一个步骤都是一次完整的事务，也就是说都落地到数据库中，数据库中的数据都发生了改变。

## 可靠消息最终一致性方案
基于 MQ 来实现事务(比如：RocketMQ)

_实际生产使用较多的方案_


## TCC与XA两阶段提交有什么区别？

1. XA是资源（数据库）的分布式事务，强一致性，在整个过程中，数据一直锁住状态；即从prepare到commit、rollback的整个过程中，TM一直把持着数据库的锁，如果有其他人要修改数据库的该条数据，就必须等待锁的释放。（简单一句话就是长事务风险）<br/>
另外在开发过程中，开发人员无感知XA的代码入侵（从Atomikos的例子我们可以感受到）<br/>
2. TCC是业务的分布式事务，最终一致性，不会出现长事务的锁风险。
> 为什么TCC不会出现长事务的锁风险呢？因为try是本地事务，锁定资源后就提交事务，confirm和cancel也是本地事务，可以直接提交事务；故多个短事务不会出现长事务的风险。<br/>
> 
> 在开发过程中，开发人员感受到两阶段提交的存在；即开发人员必须实现try、confirm和cancel方法。

3. TCC中每一个步骤是一次独立的XA事务，而整个两阶段提交是一次XA事务。
