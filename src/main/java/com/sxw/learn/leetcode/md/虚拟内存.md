# 面试题：请解释一下什么是虚拟内存？
内存对于用户来说就是一个字节数组，我们可以根据地址来访问到某个字节或者某些字节

没有虚拟内存前，只能直接操作内存，这样的弊端：
1. 地址空间不隔离（分段解决）
2. 程序运行时候的地址不确定（分段解决）
3. 内存使用率低下（分页解决）

针对以上问题，操作系统提供了虚拟内存，相当于中间加了一层。

就不需要用户直接操作内存了，让用户在编程序的时候直接把内存想象成一个非常非常大的字节数组，自己在这个字节数组上可以随便折腾，他们把这个非常大的字节数组称之为**虚拟内存**。</br>
由操作系统完成从*虚拟内存的虚拟地址到真实内存或者磁盘地址的映射*工作。这样子给用户提供的虚拟内存的地址空间就可以非常非常大(因为用到了磁盘)。

如果内存空间超过了真实内存的大小，会使用硬盘。

用户程序中那些很久都用不到的内存空间可以被操作系统给搞到磁盘上边存储，什么时候需要用了，又从磁盘中加载到真实内存中

**分段/分页**
首先，这两个技术都是为了**利用和管理好计算机的资源--内存**。

分段和分页的区别在于：粒度


**分段：**

划分方式：根据程序的逻辑角度

弊端：内存碎片

如何解决：内存交换（Swap 空间），这个过程就会出现卡顿

**分页：**

划分方式：页，连续并且尺寸固定的内存空间，Linux 下，每一页的大小为 4KB

要解决的问题：分段在进行内存交换的时候空间太大



**分页是怎么解决分段的内存碎片、内存交换效率低的问题？**

如果内存空间不够，操作系统会把其他正在运行的进程中的「最近没被使用」的内存页面给释放掉，也就是暂时写在硬盘上，称为换出（Swap Out）。
一旦需要的时候，再加载进来，称为换入（Swap In）。

所以，一次性写入磁盘的也只有少数的一个页或者几个页，不会花太多时间，内存交换的效率就相对比较高。

更进一步地，分页的方式使得我们在加载程序的时候，不再需要一次性都把程序加载到物理内存中。我们完全可以在进行虚拟内存和物理内存的页之间的映射之后，
并不真的把页加载到物理内存里，而是只有在程序运行中，需要用到对应虚拟内存页里面的指令和数据时，再加载到物理内存里面去。


参考文章：
- https://zhuanlan.zhihu.com/p/491457649
- https://www.cnblogs.com/myseries/p/12487211.html
